{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UTM Live</title>
    <script src="https://api.mapbox.com/mapbox-gl-js/v3.12.0/mapbox-gl.js"></script>
    <link href="https://api.mapbox.com/mapbox-gl-js/v3.12.0/mapbox-gl.css" rel="stylesheet" />
    <link rel="stylesheet" href="{% static 'static-app/style.css' %}">  
    <link rel="icon" href="{% static 'static-app/fav-icon-64x.png' %}" type="image/x-icon">
</head>
<body>
    <nav class="header">
        <div class="menu">
            <a class="menu-item" href="/main/">Map</a>
            <a class="menu-item" href="#undefined">Spots</a>
            {% if user.is_authenticated %}
            <a class="menu-item" href="#" onclick="document.getElementById('logout-form').submit(); return false;">Logout</a>
            <form id="logout-form" action="{% url 'logout_screen' %}" method="POST" style="display:none;">
                {% csrf_token %}
            </form>
            {% else %}
            <a class="menu-item" href="#" onclick="document.getElementById('login-form').submit(); return false;">Login</a>
            <form id="login-form" action="{% url 'login-screen' %}" style="display:none;">
            </form>
            {% endif %}
        </div>
    </nav>

    {% for location in locations %}
    <div class="location-card">
        <h2>{{ location.name }}</h2>
        <p>Type: {{ location.type }}</p>
        <p>Tags: {{ location.tags }}</p>
    </div>
    {% endfor %}

    {% if user.is_authenticated %}
    {{ location_preferences | json_script:"location-data" }}
    {% endif %}
    <script>
        let codeIds = [];
        let authenticated = {{ user.is_authenticated | yesno:"true,false" }};
        
        if (authenticated) {
            const locationData = JSON.parse(document.getElementById('location-data').textContent);
            codeIds = locationData.map(location => location.code_id);
        }
        const BASE_ASSETS_URL = "{% static 'static-app/assets/' %}";
    </script>
    <script src="{% static 'static-app/script-utils.js' %}"></script>
</body>
</html>



